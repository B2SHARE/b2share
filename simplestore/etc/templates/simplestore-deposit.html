{% extends "page.html" %}
{% block header %}
    {{ super() }}
    {% css 'css/simplestore-style.css', '50-simplestore' %}
    {% css 'css/font-awesome.min.css', '50-simplestore' %}
    <!-- Used by plupload -->
    <script type="text/javascript" src="http://bp.yahooapis.com/2.4.21/browserplus-min.js"></script>
    {% js 'js/plupload/plupload.full.js', '50-webdeposit' %}
    <!-- Note there is also js at the bottom of the template. Sigh. -->
    {% js 'js/simplestore-deposit.js', '50-simplestore' %}
{% endblock %}

{% block body%}

    <div class="container">

      <div class="row deposit">
        <h1>Deposit</h1>

        <div class="pluploader" id="fileupload">
          <div class="well" id="filebox">
            <div id="drag_and_drop_text" style="text-align:center;z-index:-100;">
              <h1><small>Drag and Drop files here</small></h1>
            </div>
          </div>
          <!-- Tables? Really? -->
          <table id="file-table" class="table table-striped table-bordered" style="display:none;">
            <thead>
              <tr>
                <th>Filename</th>
                <th>Size</th>
                <th>Status</th>
                <td></td>
              </tr>
            </thead>
            <tbody id="filelist">
            </tbody>
          </table>
          <a class="btn btn-primary" id="pickfiles" >Select files</a> 
          <a class="btn btn-success disabled" id="uploadfiles"><i class="icon-upload icon-white"></i> Start upload</a>
          <a class="btn btn-danger" id="stopupload" style="display:none;"><i class="icon-stop icon-white"></i> Stop upload</a>
          <div id="upload-errors"></div>
        </div>

      </div>
      <form method="post" action="{{ url_for('.addmeta') }}" enctype="multipart/form-data">
        <input type="hidden" id="filelist" name="filelist" value=""></input>
        <div class="row" id="domains">


          <h1>Select a domain</h1>

        <!-- id/value, text, icon -->
  {% set domain_entries = [
    ('other', 'Other', 'icon-question-sign'),
    ('ecology', 'Ecology', 'icon-leaf'),
    ('chemistry', 'Chemistry', 'icon-beaker'),
    ('geography', 'Geography', 'icon-globe'),
    ('medicine', 'Medicine', 'icon-stethoscope'),
    ('compsci', 'Computer Science', 'icon-laptop'),
    ('economics', 'Economics', 'icon-money'),
    ('linguistics', 'Linguistics', 'icon-quote-right')
  ] -%}
  {% set default_domain = default_domain|default('other') -%}


  {% for id, text, icon in domain_entries %}
  <div class="domain {% if id == default_domain %} highlight-icon{% endif %}">
    <input type="radio" class="visuallyhidden" name="domain" id="{{ id }}" value="{{ id }}" 
    {% if id == default_domain %}checked="checked"{% endif %}/>
    <label for="{{ id }}">
      &nbsp;<i class="{{ icon }} icon-large icon-4x"></i>
      <h5>{{ text }}</h5>
    </label>
  </div>
  {% endfor %}


      <div class="dep-submit span9 pull-left">
        <button class="btn btn-primary btn-large" id="submit-deposit">Submit Deposit</button>
      </div>

      </div>
    </form>
  </div>

{% endblock %}

{% block javascript %}
{{ super() }}

<script type="text/javascript">

$(document).ready(function() {

  simplestore_init_plupload('.pluploader',
                            '{{ url_for('.plupload', uid=uuid) }}',
                            '{{ url_for('.plupload_delete', uid=uuid) }}',
                            '{{ url_for('.plupload_get_file', uid=uuid) }}');

  //think this is used to update file upload status?
  simplestore_check_status('{{ url_for('.check_status', uuid=uuid) }}');
  });
</script>
{% endblock %}
